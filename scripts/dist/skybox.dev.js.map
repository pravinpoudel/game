{"version":3,"sources":["skybox.js"],"names":["canvas","document","getElementById","gl","getContext","programSkybox","webglUtils","createProgramFromSources","vsSkybox","fsSkybox","vao","createVertexArray","bindVertexArray","apositionLocation","getAttribLocation","modelLocation","getUniformLocation","VPuniformLocation","positionBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","cubePosition","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","FLOAT","indexedImage","Image","crossOrigin","cubeMapTexture","createTexture","bindTexture","TEXTURE_CUBE_MAP","i","length","cubeImageSources","src","texImage2D","TEXTURE_CUBE_MAP_POSITIVE_X","RGBA","UNSIGNED_BYTE","cameraAngle","draw","resizeCanvasToDisplaySize","viewport","width","height","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","enable","CULL_FACE","BLEND","DEPTH_TEST","useProgram","modelAngle","modelMatrix","m4","yRotation","translate","uniformMatrix4fv","camera","viewMatrix","inverse","fov","Math","PI","aspectRatio","clientWidth","clientHeight","projectionMatrix","perspective","multiply","drawArrays","TRIANGLE_STRIP","window","requestAnimationFrame"],"mappings":"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","sourcesContent":["(function () {\r\n  let canvas = document.getElementById(\"main-canvas\");\r\n  let gl = canvas.getContext(\"webgl2\");\r\n\r\n  let programSkybox = webglUtils.createProgramFromSources(gl, [\r\n    vsSkybox,\r\n    fsSkybox,\r\n  ]);\r\n\r\n  let vao = gl.createVertexArray();\r\n  gl.bindVertexArray(vao);\r\n\r\n  let apositionLocation = gl.getAttribLocation(programSkybox, \"a_position\");\r\n  let modelLocation = gl.getUniformLocation(programSkybox, \"u_modelMatrix\");\r\n  let VPuniformLocation = gl.getUniformLocation(programSkybox, \"u_VPmatrix\");\r\n\r\n  let positionBuffer = gl.createBuffer();\r\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\r\n  gl.bufferData(\r\n    gl.ARRAY_BUFFER,\r\n    new Float32Array(cubePosition),\r\n    gl.STATIC_DRAW\r\n  );\r\n\r\n  gl.enableVertexAttribArray(apositionLocation);\r\n  gl.vertexAttribPointer(apositionLocation, 3, gl.FLOAT, false, 0, 0);\r\n\r\n  let indexedImage = new Image();\r\n  indexedImage.crossOrigin = \"\";\r\n\r\n  let cubeMapTexture = gl.createTexture();\r\n  gl.bindTexture(gl.TEXTURE_CUBE_MAP, cubeMapTexture);\r\n\r\n  for (let i = 0, length = cubeImageSources.length; i < length; i++) {\r\n    indexedImage.src = `/images/texture/${cubeImageSources[i]}`;\r\n    gl.texImage2D(\r\n      gl.TEXTURE_CUBE_MAP_POSITIVE_X + i,\r\n      0,\r\n      gl.RGBA,\r\n      gl.RGBA,\r\n      gl.UNSIGNED_BYTE,\r\n      indexedImage\r\n    );\r\n  }\r\n\r\n  let cameraAngle = 0;\r\n\r\n  function draw() {\r\n    webglUtils.resizeCanvasToDisplaySize(gl.canvas);\r\n    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n\r\n    gl.clearColor(1.0, 1.0, 1.0, 1.0);\r\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n    gl.enable(gl.CULL_FACE);\r\n    gl.enable(gl.BLEND);\r\n    gl.enable(gl.DEPTH_TEST);\r\n\r\n    gl.useProgram(programSkybox);\r\n    gl.bindVertexArray(vao);\r\n\r\n    let modelAngle = 0;\r\n    let modelMatrix = m4.yRotation(modelAngle);\r\n    modelMatrix = m4.translate(modelMatrix, 0.5, 0.0, 0.0);\r\n    gl.uniformMatrix4fv(modelLocation, false, modelMatrix);\r\n\r\n    cameraAngle += 0.01;\r\n    let camera = m4.yRotation(cameraAngle);\r\n    camera = m4.translate(camera, 0.0, 0.0, 4.5);\r\n    let viewMatrix = m4.inverse(camera);\r\n\r\n    let fov = Math.PI / 3.0;\r\n    let aspectRatio = gl.canvas.clientWidth / gl.canvas.clientHeight;\r\n    let projectionMatrix = m4.perspective(fov, aspectRatio, 0.1, 1000);\r\n\r\n    projectionMatrix = m4.multiply(projectionMatrix, viewMatrix);\r\n\r\n    // let indicesBuffer = gl.createBuffer();\r\n    // gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indicesBuffer);\r\n    // gl.bufferData(\r\n    //   gl.ELEMENT_ARRAY_BUFFER,\r\n    //   new Uint8Array(indexArray),\r\n    //   gl.STATIC_DRAW\r\n    // );\r\n\r\n    gl.uniformMatrix4fv(VPuniformLocation, false, projectionMatrix);\r\n\r\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, cubePosition.length / 3);\r\n    window.requestAnimationFrame(draw);\r\n  }\r\n\r\n  draw();\r\n  window.requestAnimationFrame(draw);\r\n})();\r\n"],"file":"skybox.dev.js"}