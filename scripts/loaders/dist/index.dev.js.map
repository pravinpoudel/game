{"version":3,"sources":["index.js"],"names":["draw","webglUtils","resizeCanvasToDisplaySize","gl","canvas","viewport","width","height","clear","DEPTH_BUFFER_BIT","COLOR_BUFFER_BIT","enable","DEPTH_TEST","CULL_FACE","clearColor","modelAngle","modelMatrix","m4","yRotation","uniformMatrix4fv","modelMatrixLocation","aspect","clientWidth","clientHeight","fov","Math","PI","projectionMatrix","perspective","uniform1f","scaleLocation","vProjectionMatrix","multiply","viewMatrix","viewProjectionLocation","bufferLists","forEach","positionBuffer","colorBuffer","length","bindBuffer","ARRAY_BUFFER","enableVertexAttribArray","positionLocation","vertexAttribPointer","FLOAT","vertexColorLocation","drawArrays","TRIANGLES","window","requestAnimationFrame","document","getElementById","getContext","console","log","program","createProgramFromSources","loader_VS","loader_FS","useProgram","getAttribLocation","getUniformLocation","objLoader","geometries","minMax","minValue","min","maxValue","max","range","subtractVectors","maxSideLength","offSet","scaleVector","addVectors","vao","createVertexArray","bindVertexArray","cameraAngle","distanceScale","map","geometry","createBuffer","localPosition","attributes","position","bufferData","Float32Array","STATIC_DRAW","vColor","colorValue","cameraMatrix","translate","cameraPosition","lookAt","inverse"],"mappings":";;;;;;;;;;AAAA,CAAC;AAAA,kRAuEUA,IAvEV;;AAAA;AAAA;AAAA;AAAA;AAuEUA,UAAAA,IAvEV,oBAuEiB;AACdC,YAAAA,UAAU,CAACC,yBAAX,CAAqCC,EAAE,CAACC,MAAxC;AACAD,YAAAA,EAAE,CAACE,QAAH,CAAY,CAAZ,EAAe,CAAf,EAAkBF,EAAE,CAACC,MAAH,CAAUE,KAA5B,EAAmCH,EAAE,CAACC,MAAH,CAAUG,MAA7C;AAEAJ,YAAAA,EAAE,CAACK,KAAH,CAASL,EAAE,CAACM,gBAAH,GAAsBN,EAAE,CAACO,gBAAlC;AACAP,YAAAA,EAAE,CAACQ,MAAH,CAAUR,EAAE,CAACS,UAAb;AACAT,YAAAA,EAAE,CAACQ,MAAH,CAAUR,EAAE,CAACU,SAAb;AACAV,YAAAA,EAAE,CAACW,UAAH,CAAc,GAAd,EAAmB,GAAnB,EAAwB,GAAxB,EAA6B,GAA7B;AAEAC,YAAAA,UAAU,IAAI,IAAd;AACA,gBAAIC,WAAW,GAAGC,EAAE,CAACC,SAAH,CAAaH,UAAb,CAAlB;AACAZ,YAAAA,EAAE,CAACgB,gBAAH,CAAoBC,mBAApB,EAAyC,KAAzC,EAAgDJ,WAAhD;AAEA,gBAAIK,MAAM,GAAGlB,EAAE,CAACC,MAAH,CAAUkB,WAAV,GAAwBnB,EAAE,CAACC,MAAH,CAAUmB,YAA/C;AACA,gBAAIC,GAAG,GAAIC,IAAI,CAACC,EAAL,GAAU,GAAX,GAAkB,EAA5B;AACA,gBAAIC,gBAAgB,GAAGV,EAAE,CAACW,WAAH,CAAeJ,GAAf,EAAoBH,MAApB,EAA4B,GAA5B,EAAiC,IAAjC,CAAvB;AAEAlB,YAAAA,EAAE,CAAC0B,SAAH,CAAaC,aAAb,EAA4B,GAA5B;AAEA,gBAAIC,iBAAiB,GAAGd,EAAE,CAACe,QAAH,CAAYL,gBAAZ,EAA8BM,UAA9B,CAAxB;AACA9B,YAAAA,EAAE,CAACgB,gBAAH,CAAoBe,sBAApB,EAA4C,KAA5C,EAAmDH,iBAAnD;AAEAI,YAAAA,WAAW,CAACC,OAAZ,CAAoB,iBAA6C;AAAA,kBAA1CC,cAA0C,SAA1CA,cAA0C;AAAA,kBAA1BC,WAA0B,SAA1BA,WAA0B;AAAA,kBAAbC,MAAa,SAAbA,MAAa;AAC/DpC,cAAAA,EAAE,CAACqC,UAAH,CAAcrC,EAAE,CAACsC,YAAjB,EAA+BJ,cAA/B;AACAlC,cAAAA,EAAE,CAACuC,uBAAH,CAA2BC,gBAA3B;AACAxC,cAAAA,EAAE,CAACyC,mBAAH,CAAuBD,gBAAvB,EAAyC,CAAzC,EAA4CxC,EAAE,CAAC0C,KAA/C,EAAsD,KAAtD,EAA6D,CAA7D,EAAgE,CAAhE;AAEA1C,cAAAA,EAAE,CAACqC,UAAH,CAAcrC,EAAE,CAACsC,YAAjB,EAA+BH,WAA/B;AACAnC,cAAAA,EAAE,CAACuC,uBAAH,CAA2BI,mBAA3B;AACA3C,cAAAA,EAAE,CAACyC,mBAAH,CAAuBE,mBAAvB,EAA4C,CAA5C,EAA+C3C,EAAE,CAAC0C,KAAlD,EAAyD,KAAzD,EAAgE,CAAhE,EAAmE,CAAnE;AAEA1C,cAAAA,EAAE,CAAC4C,UAAH,CAAc5C,EAAE,CAAC6C,SAAjB,EAA4B,CAA5B,EAA+BT,MAAM,GAAG,CAAxC;AACD,aAVD;AAWAU,YAAAA,MAAM,CAACC,qBAAP,CAA6BlD,IAA7B;AACD,WAzGF;;AACOI,UAAAA,MADP,GACgB+C,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CADhB;AAEKjD,UAAAA,EAFL,GAEUC,MAAM,CAACiD,UAAP,CAAkB,QAAlB,CAFV;;AAAA,cAGMlD,EAHN;AAAA;AAAA;AAAA;;AAIGmD,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AAJH;;AAAA;AAQKC,UAAAA,OARL,GAQevD,UAAU,CAACwD,wBAAX,CAAoCtD,EAApC,EAAwC,CAACuD,SAAD,EAAYC,SAAZ,CAAxC,CARf;AASCxD,UAAAA,EAAE,CAACyD,UAAH,CAAcJ,OAAd;AAEIb,UAAAA,gBAXL,GAWwBxC,EAAE,CAAC0D,iBAAH,CAAqBL,OAArB,EAA8B,YAA9B,CAXxB;AAYKV,UAAAA,mBAZL,GAY2B3C,EAAE,CAAC0D,iBAAH,CAAqBL,OAArB,EAA8B,SAA9B,CAZ3B;AAaKpC,UAAAA,mBAbL,GAa2BjB,EAAE,CAAC2D,kBAAH,CAAsBN,OAAtB,EAA+B,eAA/B,CAb3B;AAcKtB,UAAAA,sBAdL,GAc8B/B,EAAE,CAAC2D,kBAAH,CAAsBN,OAAtB,EAA+B,YAA/B,CAd9B;AAeK1B,UAAAA,aAfL,GAeqB3B,EAAE,CAAC2D,kBAAH,CAAsBN,OAAtB,EAA+B,SAA/B,CAfrB,EAiBC;;AAjBD;AAAA,0CAmBoCO,SAAS,EAnB7C;;AAAA;AAAA;AAmBOC,UAAAA,UAnBP,QAmBOA,UAnBP;AAmBmBC,UAAAA,MAnBnB,QAmBmBA,MAnBnB;AAoBYC,UAAAA,QApBZ,GAoBwCD,MApBxC,CAoBOE,GApBP,EAoB2BC,QApB3B,GAoBwCH,MApBxC,CAoBsBI,GApBtB;AAqBOC,UAAAA,KArBP,GAqBerD,EAAE,CAACsD,eAAH,CAAmBH,QAAnB,EAA6BF,QAA7B,CArBf;AAsBOM,UAAAA,aAtBP,GAsBuBvD,EAAE,CAACsB,MAAH,CAAU+B,KAAV,CAtBvB;AAuBOG,UAAAA,MAvBP,GAuBgBxD,EAAE,CAACyD,WAAH,CACbzD,EAAE,CAAC0D,UAAH,CAAcT,QAAd,EAAwBjD,EAAE,CAACyD,WAAH,CAAeJ,KAAf,EAAsB,GAAtB,CAAxB,CADa,EAEb,CAAC,GAFY,CAvBhB,EA4BC;;AAEIM,UAAAA,GA9BL,GA8BWzE,EAAE,CAAC0E,iBAAH,EA9BX;AA+BC1E,UAAAA,EAAE,CAAC2E,eAAH,CAAmBF,GAAnB;AACIG,UAAAA,WAhCL,GAgCmB,GAhCnB;AAiCKhE,UAAAA,UAjCL,GAiCkB,GAjClB;AAkCKiE,UAAAA,aAlCL,GAkCqB,GAlCrB;AAoCK7C,UAAAA,WApCL,GAoCmB6B,UAAU,CAACiB,GAAX,CAAe,UAACC,QAAD,EAAc;AAC7C,gBAAI7C,cAAc,GAAGlC,EAAE,CAACgF,YAAH,EAArB;AACAhF,YAAAA,EAAE,CAACqC,UAAH,CAAcrC,EAAE,CAACsC,YAAjB,EAA+BJ,cAA/B;AACA,gBAAI+C,aAAa,GAAGF,QAAQ,CAACG,UAAT,CAAoBC,QAAxC;AAEAnF,YAAAA,EAAE,CAACoF,UAAH,CACEpF,EAAE,CAACsC,YADL,EAEE,IAAI+C,YAAJ,oBAAqBJ,aAArB,EAFF,EAGEjF,EAAE,CAACsF,WAHL;AAMA,gBAAInD,WAAW,GAAGnC,EAAE,CAACgF,YAAH,EAAlB;AACAhF,YAAAA,EAAE,CAACqC,UAAH,CAAcrC,EAAE,CAACsC,YAAjB,EAA+BH,WAA/B;AACA,gBAAIoD,MAAM,GAAGR,QAAQ,CAACG,UAAT,CAAoBM,UAAjC;AAEAxF,YAAAA,EAAE,CAACoF,UAAH,CAAcpF,EAAE,CAACsC,YAAjB,EAA+B,IAAI+C,YAAJ,CAAiBE,MAAjB,CAA/B,EAAyDvF,EAAE,CAACsF,WAA5D;AAEA,mBAAO;AACLpD,cAAAA,cAAc,EAAdA,cADK;AAELC,cAAAA,WAAW,EAAXA,WAFK;AAGLC,cAAAA,MAAM,EAAE6C,aAAa,CAAC7C;AAHjB,aAAP;AAKD,WAtBiB,CApCnB;AA4DKqD,UAAAA,YA5DL,GA4DoB3E,EAAE,CAACC,SAAH,CAAa6D,WAAb,CA5DpB;AA6DCa,UAAAA,YAAY,GAAG3E,EAAE,CAAC4E,SAAH,CACbD,YADa,EAEb,GAFa,EAGb,GAHa,EAIbpB,aAAa,GAAGQ,aAJH,CAAf;AAMAc,UAAAA,cAAc,GAAG,CAACF,YAAY,CAAC,EAAD,CAAb,EAAmBA,YAAY,CAAC,EAAD,CAA/B,EAAqCA,YAAY,CAAC,EAAD,CAAjD,CAAjB;AACAA,UAAAA,YAAY,GAAG3E,EAAE,CAAC8E,MAAH,CAAUD,cAAV,EAA0B,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAA1B,EAA2C,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAA3C,CAAf;AACA7D,UAAAA,UAAU,GAAGhB,EAAE,CAAC+E,OAAH,CAAWJ,YAAX,CAAb;AAqCA3C,UAAAA,MAAM,CAACC,qBAAP,CAA6BlD,IAA7B;;AA1GD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAD","sourcesContent":["(async function () {\r\n  const canvas = document.getElementById(\"main-canvas\");\r\n  let gl = canvas.getContext(\"webgl2\");\r\n  if (!gl) {\r\n    console.log(\"context couldnot be generated\");\r\n    return;\r\n  }\r\n\r\n  let program = webglUtils.createProgramFromSources(gl, [loader_VS, loader_FS]);\r\n  gl.useProgram(program);\r\n\r\n  let positionLocation = gl.getAttribLocation(program, \"a_position\");\r\n  let vertexColorLocation = gl.getAttribLocation(program, \"a_color\");\r\n  let modelMatrixLocation = gl.getUniformLocation(program, \"u_modelMatrix\");\r\n  let viewProjectionLocation = gl.getUniformLocation(program, \"u_vpMatrix\");\r\n  let scaleLocation = gl.getUniformLocation(program, \"u_scale\");\r\n\r\n  // find the range and extend of an object to calculate the offset to properly view the object\r\n\r\n  let { geometries, minMax } = await objLoader();\r\n  let { min: minValue, max: maxValue } = minMax;\r\n  const range = m4.subtractVectors(maxValue, minValue);\r\n  const maxSideLength = m4.length(range);\r\n  const offSet = m4.scaleVector(\r\n    m4.addVectors(minValue, m4.scaleVector(range, 0.5)),\r\n    -1.0\r\n  );\r\n\r\n  // -----------------------------------------------\r\n\r\n  let vao = gl.createVertexArray();\r\n  gl.bindVertexArray(vao);\r\n  let cameraAngle = 0.0;\r\n  let modelAngle = 0.0;\r\n  let distanceScale = 1.1;\r\n\r\n  let bufferLists = geometries.map((geometry) => {\r\n    let positionBuffer = gl.createBuffer();\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\r\n    let localPosition = geometry.attributes.position;\r\n\r\n    gl.bufferData(\r\n      gl.ARRAY_BUFFER,\r\n      new Float32Array([...localPosition]),\r\n      gl.STATIC_DRAW\r\n    );\r\n\r\n    let colorBuffer = gl.createBuffer();\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer);\r\n    let vColor = geometry.attributes.colorValue;\r\n\r\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vColor), gl.STATIC_DRAW);\r\n\r\n    return {\r\n      positionBuffer,\r\n      colorBuffer,\r\n      length: localPosition.length,\r\n    };\r\n  });\r\n\r\n  let cameraMatrix = m4.yRotation(cameraAngle);\r\n  cameraMatrix = m4.translate(\r\n    cameraMatrix,\r\n    0.0,\r\n    0.0,\r\n    maxSideLength * distanceScale\r\n  );\r\n  cameraPosition = [cameraMatrix[12], cameraMatrix[13], cameraMatrix[14]];\r\n  cameraMatrix = m4.lookAt(cameraPosition, [0.0, 0.0, 0.0], [0.0, 1.0, 0.0]);\r\n  viewMatrix = m4.inverse(cameraMatrix);\r\n\r\n  function draw() {\r\n    webglUtils.resizeCanvasToDisplaySize(gl.canvas);\r\n    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n\r\n    gl.clear(gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT);\r\n    gl.enable(gl.DEPTH_TEST);\r\n    gl.enable(gl.CULL_FACE);\r\n    gl.clearColor(0.5, 0.5, 0.5, 0.5);\r\n\r\n    modelAngle += 0.01;\r\n    let modelMatrix = m4.yRotation(modelAngle);\r\n    gl.uniformMatrix4fv(modelMatrixLocation, false, modelMatrix);\r\n\r\n    let aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;\r\n    let fov = (Math.PI / 180) * 60;\r\n    let projectionMatrix = m4.perspective(fov, aspect, 0.1, 1000);\r\n\r\n    gl.uniform1f(scaleLocation, 0.5);\r\n\r\n    let vProjectionMatrix = m4.multiply(projectionMatrix, viewMatrix);\r\n    gl.uniformMatrix4fv(viewProjectionLocation, false, vProjectionMatrix);\r\n\r\n    bufferLists.forEach(({ positionBuffer, colorBuffer, length }) => {\r\n      gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\r\n      gl.enableVertexAttribArray(positionLocation);\r\n      gl.vertexAttribPointer(positionLocation, 3, gl.FLOAT, false, 0, 0);\r\n\r\n      gl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer);\r\n      gl.enableVertexAttribArray(vertexColorLocation);\r\n      gl.vertexAttribPointer(vertexColorLocation, 3, gl.FLOAT, false, 0, 0);\r\n\r\n      gl.drawArrays(gl.TRIANGLES, 0, length / 3);\r\n    });\r\n    window.requestAnimationFrame(draw);\r\n  }\r\n  window.requestAnimationFrame(draw);\r\n})();\r\n"],"file":"index.dev.js"}